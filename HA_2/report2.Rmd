---
title: "Home Assignment 2"
author: "Alfons"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Task 4
The total variation, or all of the information, is given by the sum of all eigenvalues. The function cutoff85 below uses the formula:
$\frac{\sum_{i=1}^{q}\lambda_i}{\sum_{i=1}^{p}\lambda_i} = 85\%$
to calculate the amount of principal components required for keeping 85% of the total information (or variation).
```{r}
cutoff85 <- function(){
  tot_eigv = sum(eigen_dec[["values"]])
  i = 1
  cond = 0
  while(cond <= 0.85){
    eigv = sum(eigen_dec[["values"]][1:i])
    cond = eigv/tot_eigv
    i = i + 1
  }
  return(i-1)
}
```
The cutoff85 function stops once the cond is equal or bigger than 0.85 and returns the number of principal components used.
```{r}
num_pcs <- cutoff85()
num_pcs # number of pcs required for keeping  85% the information
```
To keep 85% of the total information we only need 33 principal components.
